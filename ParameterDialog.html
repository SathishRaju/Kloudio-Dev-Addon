<!DOCTYPE html>
<html>
<head>
    <?!= include('Stylesheet'); ?>
        <style>
            .branding-below {
                bottom: 56px;
                top: 0;
            }

            .addon-footer {
                background: #efefef;
            }
           .uk-accordion-title {
                font-size: 14px;
            }
  .sidebar {
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  overflow-y: auto;
  position: absolute;
  width: 100%;
}
.branding-below {
  bottom: 25px;
  top: 0;
}
.bottom,
.bottom-left,
.button-bar {
  bottom: 0;
  position: absolute;
  border-top:1px solid #efefef;
  background: #fff;
}            
        </style>
     <link rel="stylesheet"  href="https://s3-us-west-1.amazonaws.com/kloudioforgoogle/angular-datepicker.min.css">
        
</head>

<body ng-app="app" md-theme="default" ng-cloak>
   <div class="app-loading">
   <p align="center"><img src="https://s3-us-west-1.amazonaws.com/kloudioforgoogle/rotate.gif"></p>
   </div>
   <div ng-controller="ParamCtrl" class="app-wrapper" style="display:none;">
    <div class="sidebar branding-below" >
        <div ng-if="params == null">
            <p align="center"><img src="https://s3-us-west-1.amazonaws.com/kloudioforgoogle/rotate.gif"></p>
        </div>
        <div ng-if="params != null && params.length == 0 ">
            No Filters defined.
        </div>
        <div ng-if="params != null && params.length > 0">
                <form name="paramsForm" >
                     <div class="uk-margin uk-container" ng-if="params && params.length >0">
                            <ul uk-accordion="multiple: true">
                                <li ng-repeat="p in params">
                                    <h4 class="uk-accordion-title">{{p.paramDisplayName}}</h4>
                                    <div class="uk-accordion-content">
                                        <div ng-if="p.operator !== 'between'">
                                            <input type="text" ng-model="paramValues[p.paramName]"  class="uk-input uk-form-small" ng-if="p.paramType == 'Text' || p.paramType == 'CSV'" ng-required="p.paramRequired">
                                            <!--<input type="date" ng-model="paramValues[p.paramName]" class="uk-input uk-form-small" ng-if="p.paramType == 'Date'" ng-required="p.paramRequired">-->
                                               <datepicker ng-if="p.paramType === 'Date'" date-format="{{p.format ? p.format.replace('mm', 'MM') : 'yyyy-MM-dd'}}">
                                                   <input ng-model="paramValues[p.paramName]" type="text" ng-required="p.paramRequired" class=" no-spinuk-input uk-form-small" />
                                                </datepicker>
                                            <select ng-model="paramValues[p.paramName]"  class="uk-select uk-form-small" ng-if="p.paramType == 'Select'" ng-required="p.paramRequired">
                                                <option ng-repeat="row in selectData[p.paramName]" ng-value="row.value.trim()">
                                                    {{row.display}}
                                                </option>
                                            </select>
                                        </div>
                                        <div ng-if="p.operator == 'between'">
                                             <label class="uk-form-label">From:</label>
                                            <input type="text" ng-model="paramValues[p.paramName + '-from']"  class="uk-input uk-form-small" ng-if="p.paramType == 'Text'" ng-required="p.paramRequired">
                                            <!--<input type="date" ng-model="paramValues[p.paramName + '-to']" ng-value="getParamValue(p.paramName)" class="uk-input uk-form-small" ng-if="p.paramType == 'Date'" ng-required="p.paramRequired">-->
                                            <datepicker ng-if="p.paramType === 'Date'"  date-format="{{p.format ? p.format.replace('mm', 'MM') : 'yyyy-MM-dd'}}">
                                                   <input ng-model="paramValues[p.paramName + '-from']"  type="text" ng-required="p.paramRequired" class=" no-spinuk-input uk-form-small" />
                                            </datepicker>   
                                            <select ng-model="paramValues[p.paramName + '-from']"  class="uk-select uk-form-small" ng-if="p.paramType == 'Select'" ng-required="p.paramRequired">
                                                <option ng-repeat="row in selectData[p.paramName]" ng-value="row.value.trim()">
                                                    {{row.display}}
                                                </option>
                                            </select>                                            
                                        </div>
                                        <div style="display:inline-block;margin-left:5px;" ng-if="p.operator == 'between'">
                                             <label class="uk-form-label">To:</label>
                                            <input type="text" ng-model="paramValues[p.paramName + '-to']" ng-value="getParamValue(p.paramName)" class="uk-input" ng-if="p.paramType == 'Text'" ng-required="p.paramRequired">
                                            <!--<input type="date" ng-model="paramValues[p.paramName + '-to']" ng-value="getParamValue(p.paramName)" class="uk-input" ng-if="p.paramType == 'Date'" ng-required="p.paramRequired">-->
                                            <datepicker ng-if="p.paramType === 'Date'"  date-format="{{p.format ? p.format.replace('mm', 'MM') : 'yyyy-MM-dd'}}">
                                                <input ng-model="paramValues[p.paramName + '-to']" ng-value="getParamValue(p.paramName)" type="text" ng-required="p.paramRequired" class=" no-spinuk-input uk-form-small" />
                                            </datepicker>                                               
                                            <select ng-model="paramValues[p.paramName + '-to']" ng-value="getParamValue(p.paramName)" class="uk-select" ng-if="p.paramType == 'Select'" ng-required="p.paramRequired">
                                                <option ng-repeat="row in selectData[p.paramName]" ng-value="row.value.trim()">
                                                    {{row.display}}
                                                </option>
                                            </select>                                            
                                        </div>                                        
                                    </div>
                                </li>
                            </ul>
                        </div>                  
                </form>
        </div>
    </div>
        <div class="sidebar bottom" ng-if="!isLoading">
           <button class="uk-button uk-button-small uk-button-primary" id="updateSchBtn" ng-click="refreshData();" ng-disabled="queryRunning" style="margin-top:20px">
              <div ng-if="queryRunning" uk-spinner></div>
              {{queryRunning ? 'Please wait...' : 'Refresh'}}
           </button>
        <button class="uk-button uk-button-small" onClick="google.script.host.close();" style="margin-top:20px">Cancel</button>
       </div>
   </div>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://s3.amazonaws.com/kloudioassets/gsheets/js/uikit.min.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.2/angular.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.js"></script>
    <?!=include( 'ParameterJS'); ?>
        <script src="https://s3-us-west-1.amazonaws.com/kloudioforgoogle/angular-datepicker.min.js"></script>

            <script>
    $(document).ready(function()
    {
       $('.app-wrapper').css('display', 'block');
       $('.app-loading').css('display','none');
    });
    </script>
</body>

</html>